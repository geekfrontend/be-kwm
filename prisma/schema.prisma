generator client {
  provider = "prisma-client"
  output   = "./generated/client"
}

datasource db {
  provider = "mysql"
}

enum Role {
  ADMIN
  SECURITY
  EMPLOYEE
}

model User {
  id          String       @id @default(cuid())
  name        String
  email       String       @unique
  password    String
  token       String?      @db.Text
  role        Role         @default(EMPLOYEE)
  isActive    Boolean      @default(true) @map("is_active")
  createdAt   DateTime     @default(now()) @map("created_at")
  updatedAt   DateTime     @updatedAt @map("updated_at")
  attendances Attendance[]
  divisionId  String?      @map("division_id")
  division    Division?    @relation(fields: [divisionId], references: [id], onDelete: SetNull)

  @@index([divisionId])
  @@map("users")
}

model Attendance {
  id             String   @id @default(cuid())
  userId         String   @map("user_id")
  attendanceDate DateTime @map("attendance_date") @db.Date

  checkInAt  DateTime?         @map("check_in_at")
  checkOutAt DateTime?         @map("check_out_at")
  status     AttendanceStatus? @map("status")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  user User @relation(fields: [userId], references: [id])

  @@unique([userId, attendanceDate])
  @@index([userId])
  @@map("attendances")
}

enum AttendanceStatus {
  ONTIME
  LATE
}

model Division {
  id          String   @id @default(cuid())
  name        String   @unique
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  users       User[]

  @@map("divisions")
}
